---
description: Deeply explore a file and all related code, dependencies, and business logic without assumptions
---

# Deep Codebase Exploration

Target: `$ARGUMENTS` (file path)

## Your Mission

Perform an exhaustive analysis of this file and ALL code connected to it. Leave nothing out. Make no assumptions â€” verify everything by reading actual code.

## Step-by-Step Exploration Process

### 1. Initial File Analysis
- Read the entire target file line by line
- Document every import, export, function, class, variable, and type
- Note all external dependencies (packages, modules)
- Note all internal dependencies (other project files)

### 2. Trace ALL Dependencies (Go Deep)
For EVERY import/dependency found:
- Read the source file completely
- Understand what it provides and why it's needed
- Recursively trace ITS dependencies if relevant to understanding the business logic
- Continue until you've mapped the complete dependency tree
- Track depth: stop at 3 levels deep for external packages, unlimited for internal

### 3. Trace ALL Usages (Go Wide)
Search the entire codebase to find:
- Every file that imports or uses this file
- Every function/class/variable that references code from this file
- How this code fits into the larger application flow
- Priority: direct usages first, then indirect

### 4. Business Logic Deep Dive
For each function/class/method:
- What is its exact purpose?
- What are all possible inputs and outputs?
- What side effects does it have?
- What error cases does it handle?
- What assumptions does IT make?
- How does it interact with databases, APIs, or external services?

### 5. Data Flow Mapping
- Trace how data enters this code
- Trace how data is transformed
- Trace where data goes after leaving this code
- Identify all state changes
- **Create ASCII diagram showing data flow stages**

### 6. Configuration & Environment
- What config files affect this code?
- What environment variables does it depend on?
- What feature flags or conditional logic exists?

## Output Format

```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     ğŸ” DEEP EXPLORATION REPORT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“„ FILE: path/to/file.ts
ğŸ“¦ TYPE: [Component/Service/Utility/Model/etc]
ğŸ¯ PURPOSE: [One-line summary]

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ“¥ DEPENDENCIES (what this file needs)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

External Packages:
  â”œâ”€ react (v18.2.0) - hooks, components
  â”œâ”€ axios (v1.4.0) - HTTP client
  â””â”€ lodash (v4.17.21) - debounce utility

Internal Files:
  â”œâ”€ @/lib/api.ts
  â”‚   â””â”€ exports: apiClient, endpoints
  â”‚   â””â”€ purpose: centralized API configuration
  â”œâ”€ @/types/user.ts
  â”‚   â””â”€ exports: User, UserRole types
  â””â”€ @/hooks/useAuth.ts
      â””â”€ exports: useAuth hook
      â””â”€ purpose: authentication state

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ“¤ USAGES (what depends on this file)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Direct (3 files):
  â”œâ”€ pages/dashboard.tsx â†’ imports <UserProfile />
  â”œâ”€ components/navbar.tsx â†’ imports <UserProfile />
  â””â”€ layouts/main.tsx â†’ imports <UserProfile />

Indirect (2 files):
  â”œâ”€ pages/settings.tsx â†’ via layouts/main.tsx
  â””â”€ pages/profile.tsx â†’ via layouts/main.tsx

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ”§ CODE ANALYSIS
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Function: UserProfile(props: UserProfileProps)
â”œâ”€ Purpose: Display user info with edit capability
â”œâ”€ Inputs: userId (string), onEdit (callback)
â”œâ”€ State: user data, loading, error states
â”œâ”€ Side Effects:
â”‚   â””â”€ API call to /api/users/:id on mount
â”œâ”€ Error Handling:
â”‚   â”œâ”€ Network errors â†’ shows error toast
â”‚   â”œâ”€ 404 â†’ redirects to 404 page
â”‚   â””â”€ Auth errors â†’ redirects to login
â””â”€ Business Rules:
    â”œâ”€ Only owner or admin can edit
    â””â”€ Email field always visible, phone optional

[Repeat for each function/component]

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ“Š DATA FLOW DIAGRAM
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

STAGE 1: PROPS IN
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ userId: string      â”‚
â”‚ onEdit: () => void  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
STAGE 2: API FETCH
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ GET /api/users/:id  â”‚
â”‚ â†’ returns User obj  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
STAGE 3: STATE UPDATE
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ setUser(userData)   â”‚
â”‚ setLoading(false)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
STAGE 4: RENDER
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Display user info   â”‚
â”‚ Show edit button    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ”Œ INTEGRATION POINTS
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

APIs Called:
  â””â”€ GET /api/users/:id
     â”œâ”€ Auth: Required (JWT bearer token)
     â”œâ”€ Response: User object
     â””â”€ Errors: 401, 404, 500

State Management:
  â””â”€ React useState (local component state)
  â””â”€ No global state connection

External Services:
  â””â”€ None directly, but API might call auth service

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ“‹ BUSINESS RULES EXTRACTED
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

1. Access Control:
   â€¢ Only user owner or role=admin can edit profile
   â€¢ Verified by checking user.id === currentUser.id || currentUser.role === 'admin'

2. Data Display:
   â€¢ Email is always shown
   â€¢ Phone only shown if user.phone exists
   â€¢ Avatar uses gravatar if no custom image

3. Editing Flow:
   â€¢ Edit button triggers onEdit() callback
   â€¢ Parent component handles actual edit modal/form

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
âš ï¸  EDGE CASES & ERROR HANDLING
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Handled:
  âœ“ User not found (404) â†’ redirect
  âœ“ Unauthorized (401) â†’ redirect to login
  âœ“ Network errors â†’ error toast + retry button
  âœ“ Loading state â†’ skeleton UI

Not Handled:
  âœ— What if userId changes while component mounted?
  âœ— Race condition if multiple edits happen
  âœ— No timeout on API call

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
â“ QUESTIONS / UNCLEAR AREAS
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

1. Why is onEdit a callback instead of handled internally?
   â†’ Suggestion: Check parent components to understand the pattern

2. Should this component refetch on window focus?
   â†’ Current: No automatic refetch

3. Is there caching for user data?
   â†’ Current: No, fetches every mount

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ“ˆ EXPLORATION STATS
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Files Read: 12
Functions Analyzed: 8
Dependencies Traced: 6 external, 4 internal
Usages Found: 5 direct, 2 indirect
Lines of Related Code: ~450

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

## Critical Rules

1. **READ the actual code** â€” do not guess or assume based on names
2. **Follow EVERY thread** â€” if something is imported, go read it
3. **Be thorough** â€” a 10-line file might connect to 50 others
4. **Document uncertainty** â€” if something is unclear, say so explicitly
5. **No shortcuts** â€” explore completely before summarizing
6. **Use visual diagrams** â€” ASCII boxes, arrows, and hierarchy for data flow
7. **Track exploration depth** â€” report how many files analyzed at the end

Begin your deep exploration now.
