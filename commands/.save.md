---
name: save
description: Save current session context with optional note
---

## Step 1: Detect Project Name

Dynamically detect project name for storage path:

```bash
# Try git remote first (works for worktrees too)
git remote get-url origin 2>/dev/null
```

Extract repo name from URL:
- `https://bitbucket.org/org/my-project.git` → `my-project`
- `git@github.com:user/my-project.git` → `my-project`
- If no git remote, use: `basename $(pwd)` or parent directory name

## Step 2: Create Session File

Store centrally in: `~/.claude/history/{project-name}/`

Create directory if it doesn't exist:
```bash
mkdir -p ~/.claude/history/{project-name}
```

Create session save file with this format:

**Filename:** `YYYY-MM-DD_HHMMSS_[description].md` (use current timestamp and description from $ARGUMENTS, or "untitled" if no description provided)

**File content:**
```markdown
# Session Save
**Date:** [current date and time]
**Repo:** [current git repo name or folder name]
**Branch:** [current git branch]
**Description:** [description from $ARGUMENTS or "untitled session"]

## Current Work
[What we're currently working on - the main goal/task]

## Technical Decisions
[Key architecture, library, and pattern choices made this session]

## Constraints & Preferences
[User-specified requirements and preferences expressed during chat, e.g., "no external deps", "prefer X over Y", "must support Z"]

## Files Modified
[List of files changed/created and brief reason why]

## What Didn't Work
[Approaches tried and abandoned, with reasons why they failed]

## Discovered Issues
[Bugs, problems, or concerns found during session - even if not yet addressed]

## Open Questions
[Unresolved decisions or things needing more info/research]

## Assumptions
[Things we assumed to be true that informed our approach]

## Progress
**Completed:**
- [What's done]

**Remaining:**
- [What's left to do]

## Important Context
[Any other critical information needed to resume - dependencies, environment details, related systems, etc.]

## Next Steps
[Immediate next actions when resuming]
```

**Instructions:**
1. Review the entire conversation history thoroughly before creating the save
2. Be specific and concrete - use actual file names, function names, error messages
3. Include direct quotes for critical user preferences when possible
4. Don't omit something just because it seems minor - context is cheap, losing it is expensive

After creating the file, respond: "✓ Session saved to ~/.claude/history/{project-name}/[filename]"